!contents -R2 -g -p -f -h
'''In order to amend issued certificate, a dvsa admin has to be able to amend issued certificate'''

!|GenerateTestDataForOtherFitnesseTests|
|siteId?        |testerUsername?       |
|$siteId1=      |$testerUsername1=     |

Modify selected vehicle fields duplicate or replacement. 
Vehicle (class 4) is generated.

!|Replacement Certificate Issue Admin|$testerUsername1                                                                                         |
|Site Id                             |New Vrm|New Vin        |Old Primary Colour|New Primary Colour|Reason             |Is Certificate Updated?|
|$siteId1                            |NEW007 |NEWDEFT12345678|M                 |S                 |Just another reason|true                   |

'''In order to amend issued certificate a tester has to be able to issue a replacement certificate'''

Vehicle (class 4) is generated.

!|Replacement Certificate Issue Tester|$testerUsername1                                                                                                                                                                     |
|Site Id                              |Old odometer reading|New odometer reading|Old Primary Colour|New Primary Colour|Old Secondary Colour|New Secondary Colour|One Time Password|Is Certificate Updated?|Info About Result|
|$siteId1                             |1234                |4321                |S                 |M                 |M                   |S                   |000000           |false                  |Invalid OTP      |
|$siteId1                             |1234                |4321                |S                 |M                 |M                   |S                   |123456           |true                   |Valid OTP        |


These users can not issue replacement certificates.
(Vehicle, replacement draft and a tester marked as inactive are generated.)

!|ReplacementCertificateIssueNotPermittedUsers|$testerUsername1         |$siteId1                                                           |
|Role                                         |Username                 |Can Get Draft?|Can Create Draft?|Can Update Draft?|Can Apply Draft?|
|AEDM                                         |aedm                     |false         |false            |false            |false           |
|AED                                          |aed1                     |false         |false            |false            |false           |
|VTS Site Manager                             |site-manager             |false         |false            |false            |false           |
|DVLA Central Operative                       |do                       |true          |true             |true             |true            |
|Customer Service Centre Operative            |csco                     |false         |false            |false            |false           |
|MOT Scheme Manager                           |schememgt                |false         |false            |false            |false           |
|MOT Scheme User                              |schemeuser               |false         |false            |false            |false           |
|Vehicle Examiner                             |ft-enf-tester            |false         |false            |false            |false           |
|Tester (Inactive)                            |generated-inactive-tester|false         |false            |false            |false           |


The test checks if tester can issue replacements of tests performed within and outside of 7 day period

!| Date intervals for other tests    |
|DaysInterval|In Future|DateVariable?|
|7           |false    |$minusSeven= |
|8           |false    |$minusEight= |

!|Replacement Certificate Issue within seven days for tester|
|Date of Test|Can Tester Issue Replacement?|Can Apply Draft?|
|$minusSeven |true                         |true            |
|$minusEight |true                         |false           |
