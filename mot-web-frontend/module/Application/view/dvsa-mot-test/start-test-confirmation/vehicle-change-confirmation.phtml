<?php
use DvsaMotTest\ViewModel\StartTestConfirmationViewModel;

/**
 * @var StartTestConfirmationViewModel $viewModel
 */


$title = 'Vehicle details changed';
$header = 'Vehicle Details Changed';

/** @var \Dvsa\Mot\ApiClient\Resource\Item\Vehicle $vehicleDetails */
$vehicleDetails = $this->vehicleDetails;

$this->headTitle($title);
echo $this->partial(
    'motTestProgress',
    [
        'currentStep' => 1,
        'title' => $header,
        'isMotContingency' => $this->isMotContingency
    ]
);
echo $this->partial('errorMessages', ['getFromFlash' => true]);
?>

<form action="<?php echo $viewModel->getConfirmActionUrl() ?>" method="POST">

    <?php echo $this->csrfToken() ?>
    <input type="hidden" name="colourId"
           value="<?php echo $this->escapeHtmlAttr($colourId); ?>" />
    <input type="hidden" name="secondaryColourId"
           value="<?php echo $this->escapeHtmlAttr($secondaryColourId); ?>" />
    <input type="hidden" name="vehicleClassId"
           value="<?php echo $this->escapeHtmlAttr($vehicleClassId); ?>" />
    <input type="hidden" name="fuelTypeId"
           value="<?php echo $this->escapeHtmlAttr($fuelTypeId); ?>" />
    <input type="hidden" name="motTestType"
           value="<?php echo $this->escapeHtmlAttr($viewModel->getMethod()); ?>" />
    <input type="hidden" name="changeConfirmed" value="1" />

    <div class="row">
        <div class="col-sm-8">
            <?php
                echo $this->partial(
                    'otpInput',
                    [
                        'canTestWithoutOpt' => $this->canTestWithoutOtp(),
                        'errorMessage' => $this->otpErrorMessage,
                        'shortErrorMessage' => $this->otpErrorShortMessage
                    ]
                );
                if ($this->canTestWithoutOtp())
                {
                    echo $this->partial(
                        '2faDeclaration',
                        [
                            'declarationMessage' => 'By saving this vehicle record you confirm that the changes you have made are in line with DVSA conditions for MOT testing.'
                        ]
                    );
                }

            ?>
            <nav class="module-content-navigation">
                <input type="submit" class="button" value="Confirm changes" id="confirm_vehicle_changes">
                <ul class="content-navigation_secondary">
                    <li>
                        <a href="<?php echo $viewModel->getConfirmActionUrl() ?>">Cancel vehicle changes</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

</form>
